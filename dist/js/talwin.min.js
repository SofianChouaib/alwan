!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Talwin",[],e):"object"==typeof exports?exports.Talwin=e():t.Talwin=e()}(self,(function(){return function(){"use strict";var t={d:function(e,l){for(var i in l)t.o(l,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:l[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};t.d(e,{default:function(){return wt}});const l=document,i=l.body,r=l.documentElement,n="button",a="svg",o="open",s="close",p="color",u="click",c="mousedown",h="scroll",d="keydown",f="input",g="change",m="focusin",w="focusout",v="hex",_="rgb",y="hsl",b="hsv",$="tw-focus",x="tw-btn",S="tw-color",E="remove",A=[v,_,y],{max:L,min:O,round:C}=Math,H=parseFloat,T=parseInt,j=(t,e)=>{for(const l in t)if(Object.hasOwnProperty.call(t,l)&&e(t[l],l,t))return!1;return!0},k=(t,...e)=>Object.assign(t,...e),I=(t,e)=>j(t,((t,l)=>!e||e[l]!==t)),M=t=>"string"==typeof t,V=t=>null!=t,B=(t,e,l)=>O(L(t,l||0),e||100),N=(t,e,l)=>{if(t._clr.updateByString(e,!0)){let e=t._e.emit;e(p,l),e(g,l)}},P=(t,e,i)=>M(t)?t&&(e||l)["querySelector"+(i?"All":"")](t):t instanceof Element?t:null,D=(t,e,l,i,r)=>{i=i||{};const n="http://www.w3.org/"+(t===a?"2000/svg":"1999/xhtml"),o=document.createElementNS(n,t||"div");return e&&(o.className=e),j(i,((t,e)=>{"html"===e?X(o,t):"text"===e?o.innerText=t:t&&o.setAttributeNS("",e,t)})),l&&l.appendChild(o),r&&r(o),o},z=t=>t&&t.getBoundingClientRect(),F=t=>t.parentElement,R=(t,e)=>F(e).replaceChild(t,e)&&t,Z=(t,e)=>t&&F(t).removeChild(t)&&(e?null:t),q=(t,e,l)=>{t&&t.style.setProperty("--"+e,l)},K=(t,e)=>{let l=e&&e.length;null!=l&&(e=l),t.style.display=e?"":"none"},U=(t,e,l)=>{e&&t.classList[l?"add":E](e)},X=(t,e)=>{t.innerHTML=e||""},Y={id:"",classname:"",theme:"light",toggle:!0,popover:!0,position:"bottom-start",margin:8,preset:!0,color:"#000",default:"#000",target:"",disabled:!1,format:"rgb",singleInput:!1,inputs:{rgb:!0,hex:!0,hsl:!0},opacity:!0,preview:!0,copy:!0,swatches:[]},G=(t,e)=>{let l=(e?E:"add")+"EventListener",[i,r,n,a]=t;M(r)&&(r=[r]),r.forEach((t=>{i[l](t,n,a)}))},J=(t,e,l,i,r)=>{if(e){let n=[e,l,i,r=r||!1];G(n),t.push(n)}return t},Q=(t,e)=>t.filter((t=>e!==t[0]||G(t,!0))),W={top:1,right:2,bottom:3,left:4},tt={start:5,center:6,end:7},et={"aria-role":"none",focusable:"false"},lt=(t,e,l,i)=>({width:t,height:e,viewBox:l,html:i}),it=k(lt("18","18","0 0 24 24",'<path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path>'),et),rt=k(lt("18","18","0 0 24 24",'<path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"></path>'),et),nt=k(lt("15","15","0 0 20 20",'<path d="M10 1L5 8h10l-5-7zm0 18l5-7H5l5 7z"></path>'),et),at=t=>{let e=t.h/60,l=t.s,i=t.v,r=(t,e,l)=>255*(l-l*e*L(0,O(t,4-t,1)));return{r:C(r((5+e)%6,l,i)),g:C(r((3+e)%6,l,i)),b:C(r((1+e)%6,l,i)),a:t.a}},ot=(t,e)=>{let l=t;if(!M(t)){let i="",r="",n=", ";t.a<1&&(i="a",r=n+t.a);let a=e===y?"%":"";l=e+i+"("+t[e[0]]+n+t[e[1]]+a+n+t[e[2]]+a+r+")"}return l},st=t=>{let e=t.toString(16);return e.length<2?"0"+e:e},pt=({r:t,g:e,b:l,a:i})=>"#"+st(t)+st(e)+st(l)+(i<1?st(C(255*i)):""),ut=(t,e)=>{e=e?"%":0;let l=t.v,i=l*(1-t.s/2),r=i&&1!==i?(l-i)/O(i,1-i):0;return{h:t.h,s:C(100*r)+e,l:C(100*i)+e,a:C(100*t.a)/100}},ct=D("canvas").getContext("2d"),ht=/^hsla?\(\s*([+-]?\d*\.?\d+)(\w*)?(?:(?:\s+([+-]?\d*\.?\d+)%\s*([+-]?\d*\.?\d+)%(?:\s*\/\s*([+-]?\d*\.?\d+%?))?)|(?:\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%(?:\s*,\s*([+-]?\d*\.?\d+%?))?))\s*\)?$/i,dt=/^#[0-9a-f]{6}$/i,ft=(t,e)=>{let l,i;if((t=t.trim()).length>=10){const e=t.match(ht);if(e){let t=H(e[1]),r=e[2],n=B(e[3]||e[6]),a=B(e[4]||e[7]),o=e[5]||e[8];t*="turn"===r?360:"rad"===r?180/PI:"grad"===r?.9:1;let s=360;t=(C(t)%s+s)%s,o=o?B("%"===o.slice(-1)?H(o)/100:o,1):1,l={h:t,s:n,l:a,a:o},i=y}}if(!l){if(ct.fillStyle="#000",ct.fillStyle=t,t=ct.fillStyle,dt.test(t))l={r:T((r=t).slice(1,3),16),g:T(r.slice(3,5),16),b:T(r.slice(5,7),16),a:1};else{let[e,i,r,n]=t.match(/\((.+)\)/)[1].split(",").map((t=>H(t)));l={r:e,g:i,b:r,a:n?C(100*n)/100:1}}i=_}var r;return e?ot(l,i):{c:l,f:i}},gt=(t,e)=>{const _=t=>D("","talwin__container",t);let y=((t,e)=>{const l={$:t,e:[],init(e){let{preset:r,classname:a}=e,{$:o,e:s}=l;s=Q(s,o),r!==(o!==t)&&(o=r?R(D(n,"tw-ref",null,{type:n,id:t.id}),t):R(t,o)),a&&a.split(/\s+/).map((t=>{U(o,t,!0)})),J(s,o,u,i),l.$=o,l.e=s}},i=t=>{e.toggle()};return l})(t,e),b=(t=>{let e,{config:n,_e:{emit:a},_clr:p}=t,u=D("","talwin",i),f={e:[]},g=!1,m=[];const w=e=>{var i;g&&(y(),i=t._ui.ref.$,m.every((t=>{let e=!0;if(t!==l){let{top:l,bottom:r}=z(i),{top:n,bottom:a}=z(t);e=l>=n&&a>=r}return e}))||$(!0))},v=t=>{let e=f.e;m.forEach((l=>{e=t(e,l,h,w)})),e=t(e,window,"resize",w),e=t(e,l,[c,d],_),f.e=e},_=e=>{if(g){let l,{target:i,type:r,key:n,shiftKey:a}=e,o=t._ui,s=o.ref.$,p=o.palette.$;"Escape"===n||r===c&&s!==i&&!u.contains(i)?$():"Tab"===n&&(i!==s||a?(!a&&i===(t=>{let e=P("button,input",t,!0);return e[e.length-1]})(u)||i===p&&a)&&(l=s):l=p,l&&(e.preventDefault(),l.focus()))}},y=()=>{e&&e.update()},b=t=>{g||n.disabled||(p.update({},!0),y(),U(u,o,!0),g=!0,!t&&a(o))},$=t=>{g&&n.toggle&&(U(u,o,!1),g=!1,!t&&a(s))},x=e=>{n.disabled=e,e&&$(!0),U(t._ui.ref.$,"tw-disabled",e)};return k(f,{$:u,init:n=>{let{theme:a,popover:o,target:s,position:p,margin:c,disabled:d,id:g,toggle:w}=n,_=t._ui.ref.$,y=P(s),$=y||_;g&&(u.id=g),v(Q),x(d),u.dataset.theme=a,w||b(!0),K(_,o||w),o?(f.popper=e=((t,e,l)=>{let n,a,o,s,p,u,c,h,d,f,g,m,w,v;l=l||{};let _=parseFloat(l.margin)||4,y=l.position?l.position.split("-"):[],b=W[y[0]]||3,$=y[1]?tt[y[1]]||5:6,x=0,S=0,E=e.style;const A=t=>1===t&&s>=m||3===t&&w-p>=m||2===t&&v-u>=g||4===t&&o>=g,O=(t,e)=>5===t?e?v-o>=d:w-s>=f:6===t?e?2*(v-c)>=d&&2*c>=d:2*(w-h)>=f&&2*h>=f:e?u>=d:p>=f,C=t=>{x=1===t?s-m:3===t?p+_:0,S=2===t?u+_:4===t?o-g:0},H=(t,e)=>{5===t?e?S=o:x=s:6===t?e?S=o-d/2+n/2:x=s-f/2+a/2:e?S=u-d:x=p-f},T=()=>(w-f)/2,j=()=>(v-d)/2,k={1:[1,3,2,4],3:[3,1,2,4],2:[2,4,1,3],4:[4,2,1,3],5:[5,6,7],6:[6,5,7],7:[7,6,5]},I=()=>{({width:n,height:a,top:s,right:u,bottom:p,left:o}=z(t)),c=o+n/2,h=s+a/2,({width:d,height:f}=z(e)),g=d+_,m=f+_;let l=z(r);v=l.width,w=L(r.clientHeight,l.height,z(i).height);let y,I=k[b],M=!1,V=!1,B=0;for(;B<I.length&&!M;)y=I[B],A(y)&&(C(y),M=!0),B++;if(M){let t=k[$],e=1===y||3===y,l=0;for(;l<t.length&&!V;){const i=t[l];O(i,e)&&(H(i,e),V=!0),l++}V||(e?S=j():x=T())}else x=T(),S=j();E.top=x+"px",E.left=S+"px"};return I(),{update:I}})($,u,{position:p,margin:c}),m=(t=>{t=F(t);let e=[l];for(;t!==i;){let l=getComputedStyle(t).overflow;"auto"!==l&&l!==h||e.push(t),t=F(t)}return e})(_),v(J)):$.insertAdjacentElement((y?"before":"after")+"end",u),U(u,"tw-popper",o)},isOpen:()=>g,open:b,close:$,toggle:()=>{g?$():b()},disable:x,reposition:y})})(e),E=b.$,O=((t,e)=>{const{_clr:i,_e:{emit:r}}=e,n=D("","talwin__palette",t,{tabindex:"0"}),a=D("","tw-overlay",t);K(a,!1);const o=(t=>{const e=D("","talwin__marker",t),{width:l,height:i}=z(e);let r=l/2,n=i/2,a=0,o=0;return{$:e,moveTo:(t,l)=>{a=t,o=l,e.style.transform=`translate(${t-r}px, ${l-n}px)`},point:()=>({x:a,y:o})}})(n);let s,u,{moveTo:h,point:f}=o;const g={ArrowRight:1,ArrowLeft:-1},v={ArrowUp:-1,ArrowDown:1};let _,y=[],b=!1;const x=(t,e)=>{h(t,e),i.update({s:t/s,v:1-e/u}),r(p,n)},S=t=>{let e,l,{top:i,left:r}=_,n=t.touches;t.preventDefault(),n&&(t=n[0]),e=t.clientX-r,l=t.clientY-i,e=e<0?0:e>s?s:e,l=l<0?0:l>u?u:l,x(e,l)},E=t=>{({width:s,height:u}=t||z(n))};return J(y,n,[c,"touchstart"],(t=>{t.touches&&t.touches.length>1||(i.start(),_=z(n),E(_),S(t),b=!0,K(a,b),n.focus())})),J(y,l,["mousemove","touchmove"],(t=>{!b||t.touches&&t.touches.length>1||S(t)}),{passive:!1}),J(y,l,["mouseup","touchend","touchcancel"],(t=>{b&&(i.end(n),b=!1,K(a,b))})),J(y,n,[w,m],(t=>{let e=!1;t.type===w?n.blur():e=!b,U(n,$,e)})),J(y,n,d,(t=>{U(n,$,!0);let e=t.key;if(g[e]||v[e]){t.preventDefault(),E();let{x:l,y:i}=f(),r=l,n=i;l+=(g[e]||0)*(s/100),i+=(v[e]||0)*(u/100),l=l>s?s:l<0?0:l,i=i>u?u:i<0?0:i,l===r&&i===n||x(l,i)}})),{$:n,marker:o,update:t=>{E(),h(t.s*s,(1-t.v)*u)},e:y}})(E,e),C=_(E),H=((t,e)=>{let l=!1;const i=D("","tw-mr",t),r={e:[],init(t){let{preview:e,copy:l}=t,a=r.$,s=r.cp;e!==!!a&&(a=e?D("","talwin__preview",i):Z(a,!0),l&&s&&(a||i).appendChild(s)),l?s||(s=D(n,x,a||i,{type:n},(t=>{o(t)}))):s=Z(s,!0),K(i,s||a),r.$=a,r.cp=s}},o=t=>{t=t||r.cp,X(t),D(a,"",t,l?rt:it)};return J(r.e,i,[u,"mouseleave",m,w],(t=>{if(r.cp&&!e.config.disabled){let i=t.type,n=i===m;l||i!==u?(n||l&&(l=!1,o()),U(r.cp,$,n)):(l=e._clr.copy(),o())}})),r})(C,e),I=((t,e)=>{const l=D("","tw-w100",t),i=e._clr.update,r=(t,e,i)=>D(f,t,l,{type:"range",max:e,step:i}),n={e:[],hue:r("talwin__slider talwin__slider--hue",360),alpha:null,init({opacity:t}){let e=n.alpha;t!==!!e&&(n.alpha=t?r("talwin__slider talwin__slider--alpha",1,.01):Z(e,!0)||i({a:1}))},val(t){let{alpha:e,hue:l}=n;l.value=360-t.h,e&&(e.value=t.a)}};return J(n.e,l,[f,g],(t=>{let l=t.target,r=l.valueAsNumber,a={};l===n.hue?a.h=360-r:a.a=r,i(a),e._e.emit(t.type===g?g:p,l)})),n})(C,e),M=((t,e)=>{const l={};let i,r,o,s,c=[],h=[];const{config:w,_clr:_,_e:{emit:y}}=e;l.init=e=>{let l,{inputs:s,format:p}=e;c=A.filter((t=>s[t])),l=c.length,l?(i||(i=D("","talwin__inputs",t)),1===l?r=Z(r,!0):r||(r=D(n,x,t,{type:n},(t=>{D(a,"",t,nt)}))),o=L(c.indexOf(p),0),p=c[o]):(i=Z(i,!0),r=Z(r,!0),p=A.includes(p)?p:A[0]),w.format=p,b(p),K(t,l)};const b=t=>{if(l.$={},s=[],i){let{singleInput:e,opacity:r}=w,n=e||t==v?[t]:(t+(r?"a":"")).split("");X(i),n.forEach(((t,e)=>{D("label","tw-label",i,!1,(i=>{l.$[t]=s[e]=D(f,"talwin__input",i,{type:"text"}),D("span","",i,{text:t})}))})),_.update({})}};return l.val=t=>{j(l.$,((e,l)=>{e.value=t[l]}))},J(h,t,u,(t=>{t.target===r&&(o=(o+1)%c.length,w.format=c[o],b(c[o]))})),J(h,t,f,(t=>{let e=t.target.value;if(e.trim()){let t="",i=c[o];t=w.singleInput||i===v?e:i+"("+s.reduce(((t,e)=>(t&&t+",")+e.value),"")+")",_.updateByString(t,l)&&y(p,l.$)}})),J(h,t,[m,g],(t=>{t.type===m?_.start():_.end(l.$)})),J(h,t,d,(t=>{"Enter"===t.key&&e.close()})),l.e=h,l})(_(E),e),V=((t,e)=>{let l,i=D("","talwin__swatches",t);const r=t=>D(n,"talwin__swatch",i,{type:n},(e=>{q(e,S,ft(t,!0))})),a={e:[],init(t){let e=[];l=t.swatches,K(i,l),X(i),l.forEach(((t,l)=>{e[l]=r(t)})),a.$=e},add(t){let e=l.push(t)-1;a.$[e]=r(t),K(i,l)},remove(t){let e=l.findIndex(((e,l)=>t===e||T(t)===l)),r=a.$;e>-1&&(l.splice(e,1),Z(r[e]),r.splice(e,1),K(i,l))}};return J(a.e,t,u,(t=>{let l=t.target;F(l)===i&&N(e,l.style.getPropertyValue("--tw-color"),l)})),a})(E,e);return{ref:y,app:b,palette:O,preview:H,sliders:I,inputs:M,swatches:V}},mt=(t,e)=>{e=e||{};let l=t.config,i=e.color;k(l,e),j(t._ui,(t=>{let e=t.init;e&&e(l)})),i&&N(t,i)};class wt{static version="1.0.0";static defaults=Y;constructor(t,e){t=P(t);const r=this;r.config=k({},wt.defaults,e),r._e=(t=>{const{config:e}=t,l={[o]:[],[s]:[],[g]:[],[p]:[]};return{emit:(i,r)=>{!e.disabled&&l[i]&&l[i].forEach((e=>{i===p||i===g?e(t._clr.value,r||t):e()}))},on:(t,e)=>{l[t]&&l[t].push(e)},off:(t,e)=>{let i=l[t];i?l[t]=e?i.filter((t=>t!==e)):[]:null==t&&j(l,((t,e)=>{l[e]=[]}))}}})(r),r._clr=(t=>{let e,r={h:0,s:0,v:0,a:1},n=at(r),a="",{config:o,_e:s}=t;const p=(e,l,i)=>{if(!o.disabled){k(r,e),n=i||at(r),a=ot(n,_);let s=t._ui,{palette:p,sliders:c,inputs:h}=s;q(s.preview.$,S,a),q(s.ref.$,S,a),(l||!V(e.a))&&q(c.alpha,_,n.r+","+n.g+","+n.b),V(e.h)&&q(p.$,"hue",r.h),l!==h&&h.val(u("",o.singleInput)),l&&(c.val(r),p.update(r))}},u=(t,e)=>{let l=(t=t||o.format)===v,i=l?pt(n):t===y?ut(r,!e):n;return e||l?{[t]:ot(i,t)}:i},c=(t,e,l,i)=>{o.opacity&&(l+="a");let r=i?[]:{};return l!==b&&(r.toString=()=>e||ot(t,l)),l.split("").reduce(((e,l,r)=>(e[i?r:l]=t[l],e)),r)};return{value:{[b]:()=>c(r,"",b,!1),[_]:t=>c(n,a,_,t),[y]:t=>c(ut(r),"",y,t),[v]:()=>pt(n)},update:p,updateByString:(t,e)=>{let l,i,{c:r,f:n}=ft(t),a=u(n),o=!I(r,a);return o&&(n===y?i=(t=>{let e=t.s/100,l=t.l/100,i=l+e*O(l,1-l);return{h:t.h,s:i?2*(1-l/i):0,v:i,a:t.a}})(r):(l=r,i=(t=>{let e=t.r/255,l=t.g/255,i=t.b/255,r=L(e,l,i),n=r-O(e,l,i),a=0===r?0:n/r;return{h:C((360+60*(0===n?0:r===e?(l-i)/n%6:r===l?(i-e)/n+2:r===i?(e-l)/n+4:0))%360),s:a,v:r,a:C(100*t.a)/100}})(r)),p(i,e,l)),o},copy:()=>j(u("",!0),(t=>{let e=navigator.clipboard;e?e.writeText(t):D(f,"",i,null,(e=>{e.value=t,e.select(),l.execCommand("copy"),Z(e)}))})),start:()=>{e=u()},end:t=>{I(e,u())||s.emit(g,t)}}})(r),r._ui=gt(t,r),mt(r,r.config)}setOptions(t){mt(this,t)}isOpen(){return this._ui.app.isOpen()}open(){this._ui.app.open()}close(){this._ui.app.close()}toggle(){this._ui.app.toggle()}on(t,e){this._e.on(t,e)}off(t,e){this._e.off(t,e)}setColor(t){let e,l=this;if(!M(t)&&(e=[_,y,b].find((e=>e.split("").every((e=>t[e]&&!isNaN(t[e]))))),e)){let i=t.a;t.a=null!=i?i:1,e===b&&(e=l.config.format,t.h=(t.h%360+360)%360,t.s=B(t.s)/100,t.v=B(t.v)/100,e===y?t=ut(t):(t=at(t),e===v&&(t=pt(t)))),t=ot(t,e)}return l._clr.updateByString(t,!0),l}getColor(){return this._clr.value}addSwatch(t){this._ui.swatches.add(t)}removeSwatch(t){this._ui.swatches.remove(t)}enable(){this._ui.app.disable(!1)}disable(){this._ui.app.disable(!0)}reset(){N(this,this.config.default)}reposition(){this._ui.app.reposition()}trigger(t){this._e.emit(t)}destroy(){let t=this,e=t._ui;e.ref.init({preset:!1,toggle:!0}),j(e,(t=>{t.e.forEach((t=>{G(t,!0)}))})),j(t,((e,l)=>{t[l]=null}))}}return e.default}()}));
//# sourceMappingURL=talwin.min.js.map