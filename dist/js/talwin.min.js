!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Talwin",[],t):"object"==typeof exports?exports.Talwin=t():e.Talwin=t()}(self,(function(){return function(){"use strict";var e={d:function(t,l){for(var i in l)e.o(l,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:l[i]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{default:function(){return me}});const l=document,i=l.body,r=l.documentElement,n="button",a="svg",o="open",s="close",p="color",u="click",c="mousedown",h="scroll",d="keydown",f="input",g="change",m="focusin",w="focusout",v="hex",_="rgb",y="hsl",b="hsv",$="tw-focus",x="tw-btn",S="tw-color",E="remove",A=[v,_,y],{max:C,min:L,round:O}=Math,H=parseFloat,T=parseInt,j=(e,t)=>{for(const l in e)if(Object.hasOwnProperty.call(e,l)&&t(e[l],l,e))return!1;return!0},k=(e,...t)=>Object.assign(e,...t),I=(e,t)=>j(e,((e,l)=>!t||t[l]!==e)),M=e=>"string"==typeof e,V=e=>null!=e,B=(e,t,l)=>L(C(e,l||0),t||100),N=(e,t,i)=>M(e)?e&&(t||l)["querySelector"+(i?"All":"")](e):e instanceof Element?e:null,P=(e,t,l,i,r)=>{i=i||{};const n="http://www.w3.org/"+(e===a?"2000/svg":"1999/xhtml"),o=document.createElementNS(n,e||"div");return t&&(o.className=t),j(i,((e,t)=>{"html"===t?U(o,e):"text"===t?o.innerText=e:e&&o.setAttributeNS("",t,e)})),l&&l.appendChild(o),r&&r(o),o},D=e=>e&&e.getBoundingClientRect(),z=e=>e.parentElement,F=(e,t)=>z(t).replaceChild(e,t)&&e,R=(e,t)=>e&&z(e).removeChild(e)&&(t?null:e),Z=(e,t,l)=>{e&&e.style.setProperty("--"+t,l)},q=(e,t)=>{let l=t&&t.length;null!=l&&(t=l),e.style.display=t?"":"none"},K=(e,t,l)=>{t&&e.classList[l?"add":E](t)},U=(e,t)=>{e.innerHTML=t||""},X={id:"",classname:"",theme:"light",toggle:!0,popover:!0,position:"bottom-start",margin:8,preset:!0,color:"#000",default:"#000",target:"",disabled:!1,format:"rgb",singleInput:!1,inputs:{rgb:!0,hex:!0,hsl:!0},opacity:!0,preview:!0,copy:!0,swatches:[]},Y=(e,t)=>{let l=(t?E:"add")+"EventListener",[i,r,n,a]=e;M(r)&&(r=[r]),r.forEach((e=>{i[l](e,n,a)}))},G=(e,t,l,i,r)=>{if(t){let n=[t,l,i,r=r||!1];Y(n),e.push(n)}return e},J=(e,t)=>e.filter((e=>t!==e[0]||Y(e,!0))),Q={top:1,right:2,bottom:3,left:4},W={start:5,center:6,end:7},ee={"aria-role":"none",focusable:"false"},te=(e,t,l,i)=>({width:e,height:t,viewBox:l,html:i}),le=k(te("18","18","0 0 24 24",'<path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path>'),ee),ie=k(te("18","18","0 0 24 24",'<path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"></path>'),ee),re=k(te("15","15","0 0 20 20",'<path d="M10 1L5 8h10l-5-7zm0 18l5-7H5l5 7z"></path>'),ee),ne=e=>{let t=e.h/60,l=e.s,i=e.v,r=(e,t,l)=>255*(l-l*t*C(0,L(e,4-e,1)));return{r:O(r((5+t)%6,l,i)),g:O(r((3+t)%6,l,i)),b:O(r((1+t)%6,l,i)),a:e.a}},ae=(e,t)=>{let l=e;if(!M(e)){let i="",r="",n=", ";e.a<1&&(i="a",r=n+e.a);let a=t===y?"%":"";l=t+i+"("+e[t[0]]+n+e[t[1]]+a+n+e[t[2]]+a+r+")"}return l},oe=e=>{let t=e.toString(16);return t.length<2?"0"+t:t},se=({r:e,g:t,b:l,a:i})=>"#"+oe(e)+oe(t)+oe(l)+(i<1?oe(O(255*i)):""),pe=(e,t)=>{t=t?"%":0;let l=e.v,i=l*(1-e.s/2),r=i&&1!==i?(l-i)/L(i,1-i):0;return{h:e.h,s:O(100*r)+t,l:O(100*i)+t,a:O(100*e.a)/100}},ue=P("canvas").getContext("2d"),ce=/^hsla?\(\s*([+-]?\d*\.?\d+)(\w*)?(?:(?:\s+([+-]?\d*\.?\d+)%\s*([+-]?\d*\.?\d+)%(?:\s*\/\s*([+-]?\d*\.?\d+%?))?)|(?:\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%(?:\s*,\s*([+-]?\d*\.?\d+%?))?))\s*\)?$/i,he=/^#[0-9a-f]{6}$/i,de=(e,t)=>{let l,i;if((e=e.trim()).length>=10){const t=e.match(ce);if(t){let e=H(t[1]),r=t[2],n=B(t[3]||t[6]),a=B(t[4]||t[7]),o=t[5]||t[8];e*="turn"===r?360:"rad"===r?180/PI:"grad"===r?.9:1;let s=360;e=(O(e)%s+s)%s,o=o?B("%"===o.slice(-1)?H(o)/100:o,1):1,l={h:e,s:n,l:a,a:o},i=y}}if(!l){if(ue.fillStyle="#000",ue.fillStyle=e,e=ue.fillStyle,he.test(e))l={r:T((r=e).slice(1,3),16),g:T(r.slice(3,5),16),b:T(r.slice(5,7),16),a:1};else{let[t,i,r,n]=e.match(/\((.+)\)/)[1].split(",").map((e=>H(e)));l={r:t,g:i,b:r,a:n?O(100*n)/100:1}}i=_}var r;return t?ae(l,i):{c:l,f:i}},fe=(e,t)=>{const _=e=>P("","talwin__container",e);let y=((e,t)=>{const l={$:e,e:[],init(t){let{preset:r,classname:a}=t,{$:o,e:s}=l;s=J(s,o),r!==(o!==e)&&(o=r?F(P(n,"tw-ref",null,{type:n,id:e.id}),e):F(e,o)),a&&a.split(/\s+/).map((e=>{K(o,e,!0)})),G(s,o,u,i),l.$=o,l.e=s}},i=e=>{t.toggle()};return l})(e,t),b=(e=>{let t,{config:n,_e:{emit:a},_clr:p}=e,u=P("","talwin",i),f={e:[]},g=!1,m=[];const w=t=>{var i;g&&(y(),i=e._ui.ref.$,m.every((e=>{let t=!0;if(e!==l){let{top:l,bottom:r}=D(i),{top:n,bottom:a}=D(e);t=l>=n&&a>=r}return t}))||$(!0))},v=e=>{let t=f.e;m.forEach((l=>{t=e(t,l,h,w)})),t=e(t,window,"resize",w),t=e(t,l,[c,d],_),f.e=t},_=t=>{if(g){let l,{target:i,type:r,key:n,shiftKey:a}=t,o=e._ui,s=o.ref.$,p=o.palette.$;"Escape"===n||r===c&&s!==i&&!u.contains(i)?$():"Tab"===n&&(i!==s||a?(!a&&i===(e=>{let t=N("button,input",e,!0);return t[t.length-1]})(u)||i===p&&a)&&(l=s):l=p,l&&(t.preventDefault(),l.focus()))}},y=()=>{t&&t.update()},b=e=>{g||n.disabled||(p.update({},!0),y(),K(u,o,!0),g=!0,!e&&a(o))},$=e=>{g&&n.toggle&&(K(u,o,!1),g=!1,!e&&a(s))},x=t=>{n.disabled=t,t&&$(!0),K(e._ui.ref.$,"tw-disabled",t)};return k(f,{$:u,init:n=>{let{theme:a,popover:o,target:s,position:p,margin:c,disabled:d,id:g,toggle:w}=n,_=e._ui.ref.$,y=N(s),$=y||_;g&&(u.id=g),v(J),x(d),u.dataset.theme=a,o?(f.popper=t=((e,t,l)=>{let n,a,o,s,p,u,c,h,d,f,g,m,w,v;l=l||{};let _=parseFloat(l.margin)||4,y=l.position?l.position.split("-"):[],b=Q[y[0]]||3,$=y[1]?W[y[1]]||5:6,x=0,S=0,E=t.style;const A=e=>1===e&&s>=m||3===e&&w-p>=m||2===e&&v-u>=g||4===e&&o>=g,L=(e,t)=>5===e?t?v-o>=d:w-s>=f:6===e?t?2*(v-c)>=d&&2*c>=d:2*(w-h)>=f&&2*h>=f:t?u>=d:p>=f,O=e=>{x=1===e?s-m:3===e?p+_:0,S=2===e?u+_:4===e?o-g:0},H=(e,t)=>{5===e?t?S=o:x=s:6===e?t?S=o-d/2+n/2:x=s-f/2+a/2:t?S=u-d:x=p-f},T=()=>(w-f)/2,j=()=>(v-d)/2,k={1:[1,3,2,4],3:[3,1,2,4],2:[2,4,1,3],4:[4,2,1,3],5:[5,6,7],6:[6,5,7],7:[7,6,5]},I=()=>{({width:n,height:a,top:s,right:u,bottom:p,left:o}=D(e)),c=o+n/2,h=s+a/2,({width:d,height:f}=D(t)),g=d+_,m=f+_;let l=D(r);v=l.width,w=C(r.clientHeight,l.height,D(i).height);let y,I=k[b],M=!1,V=!1,B=0;for(;B<I.length&&!M;)y=I[B],A(y)&&(O(y),M=!0),B++;if(M){let e=k[$],t=1===y||3===y,l=0;for(;l<e.length&&!V;){const i=e[l];L(i,t)&&(H(i,t),V=!0),l++}V||(t?S=j():x=T())}else x=T(),S=j();E.top=x+"px",E.left=S+"px"};return I(),{update:I}})($,u,{position:p,margin:c}),m=(e=>{e=z(e);let t=[l];for(;e!==i;){let l=getComputedStyle(e).overflow;"auto"!==l&&l!==h||t.push(e),e=z(e)}return t})(_),v(G)):$.insertAdjacentElement((y?"before":"after")+"end",u),K(u,"tw-popper",o),w||b(!0),q(_,o||w)},isOpen:()=>g,open:b,close:$,toggle:()=>{g?$():b()},disable:x,reposition:y})})(t),E=b.$,L=((e,t)=>{const{_clr:i,_e:{emit:r}}=t,n=P("","talwin__palette",e,{tabindex:"0"}),a=P("","tw-overlay",e);q(a,!1);const o=(e=>{const t=P("","talwin__marker",e),{width:l,height:i}=D(t);let r=l/2-1,n=i/2-1,a=0,o=0;return{$:t,moveTo:(e,l)=>{a=e,o=l,t.style.transform=`translate(${e-r}px, ${l-n}px)`},point:()=>({x:a,y:o})}})(n),{width:s,height:u}=D(n),h=s/100,f=u/100,g={ArrowRight:h,ArrowLeft:-h},v={ArrowUp:-f,ArrowDown:f};let _,y=[],b=!1;const x=(e,t)=>{o.moveTo(e,t),i.update({s:e/s,v:1-t/u}),r(p,i.value,n)},S=e=>{let t,l,{top:i,left:r}=_,n=e.touches;e.preventDefault(),n&&(e=n[0]),t=e.clientX-r,l=e.clientY-i,t=t<0?0:t>s?s:t,l=l<0?0:l>u?u:l,x(t,l)};return G(y,n,[c,"touchstart"],(e=>{e.touches&&e.touches.length>1||(i.start(),_=D(n),S(e),b=!0,q(a,b),n.focus())})),G(y,l,["mousemove","touchmove"],(e=>{!b||e.touches&&e.touches.length>1||S(e)}),{passive:!1}),G(y,l,["mouseup","touchend","touchcancel"],(e=>{b&&(i.end(n),b=!1,q(a,b))})),G(y,n,[w,m],(e=>{let t=!1;e.type===w?n.blur():t=!b,K(n,$,t)})),G(y,n,d,(e=>{K(n,$,!0);let t=e.key;if(g[t]||v[t]){e.preventDefault();let{x:l,y:i}=o.point(),r=l,n=i;l+=g[t]||0,i+=v[t]||0,l=l>s?s:l<0?0:l,i=i>u?u:i<0?0:i,l===r&&i===n||x(l,i)}})),{$:n,marker:o,update:e=>{o.moveTo(e.s*s,(1-e.v)*u)},e:y}})(E,t),O=_(E),H=((e,t)=>{let l=!1;const i=P("","tw-mr",e),r={e:[],init(e){let{preview:t,copy:l}=e,a=r.$,s=r.cp;t!==!!a&&(a=t?P("","talwin__preview",i):R(a,!0),l&&s&&(a||i).appendChild(s)),l?s||(s=P(n,x,a||i,{type:n},(e=>{o(e)}))):s=R(s,!0),q(i,s||a),r.$=a,r.cp=s}},o=e=>{e=e||r.cp,U(e),P(a,"",e,l?ie:le)};return G(r.e,i,[u,"mouseleave",m,w],(e=>{if(r.cp&&!t.config.disabled){let i=e.type,n=i===m;l||i!==u?(n||l&&(l=!1,o()),K(r.cp,$,n)):(l=t._clr.copy(),o())}})),r})(O,t),I=((e,t)=>{let{_clr:{update:l,value:i},_e:{emit:r}}=t;const n=P("","tw-w100",e),a=(e,t,l)=>P(f,e,n,{type:"range",max:t,step:l}),o={e:[],hue:a("talwin__slider talwin__slider--hue",360),alpha:null,init({opacity:e}){let t=o.alpha;e!==!!t&&(o.alpha=e?a("talwin__slider talwin__slider--alpha",1,.01):R(t,!0)||l({a:1}))},val(e){let{alpha:t,hue:l}=o;l.value=360-e.h,t&&(t.value=e.a)}};return G(o.e,n,[f,g],(e=>{let t=e.target,n=t.valueAsNumber,a={};t===o.hue?a.h=360-n:a.a=n,l(a),r(e.type===g?g:p,i,t)})),o})(O,t),M=((e,t)=>{const{config:l,_clr:i,_e:{emit:r}}=t,o={};let s,c,h,w,_=[],y=[];o.init=t=>{let i,{inputs:r,format:o}=t;_=A.filter((e=>r[e])),i=_.length,i?(s||(s=P("","talwin__inputs",e)),1===i?c=R(c,!0):c||(c=P(n,x,e,{type:n},(e=>{P(a,"",e,re)}))),h=C(_.indexOf(o),0),o=_[h]):(s=R(s,!0),c=R(c,!0),o=A.includes(o)?o:A[0]),l.format=o,b(o),q(e,i)};const b=e=>{if(o.$={},w=[],s){let{singleInput:t,opacity:r}=l,n=t||e==v?[e]:(e+(r?"a":"")).split("");U(s),n.forEach(((e,t)=>{P("label","tw-label",s,!1,(l=>{o.$[e]=w[t]=P(f,"talwin__input",l,{type:"text"}),P("span","",l,{text:e})}))})),i.update({})}};return o.val=e=>{j(o.$,((t,l)=>{t.value=e[l]}))},G(y,e,u,(e=>{e.target===c&&(h=(h+1)%_.length,l.format=_[h],b(_[h]))})),G(y,e,f,(e=>{let t=e.target.value;if(t.trim()){let e="",n=_[h];e=l.singleInput||n===v?t:n+"("+w.reduce(((e,t)=>(e&&e+",")+t.value),"")+")",i.updateByString(e,o)&&r(p,i.value,o.$)}})),G(y,e,[m,g],(e=>{e.type===m?i.start():i.end(o.$)})),G(y,e,d,(e=>{"Enter"===e.key&&t.close()})),o.e=y,o})(_(E),t),V=((e,t)=>{const{_clr:{value:l,updateByString:i},_e:{emit:r}}=t;let a,o=P("","talwin__swatches",e);const s=e=>P(n,"talwin__swatch",o,{type:n},(t=>{Z(t,S,de(e,!0))})),c={e:[],init(e){let t=[];a=e.swatches,q(o,a),U(o),a.forEach(((e,l)=>{t[l]=s(e)})),c.$=t},add(e){let t=a.push(e)-1;c.$[t]=s(e),q(o,a)},remove(e){let t=a.findIndex(((t,l)=>e===t||T(e)===l)),l=c.$;t>-1&&(a.splice(t,1),R(l[t]),l.splice(t,1),q(o,a))}};return G(c.e,e,u,(e=>{let t=e.target;z(t)===o&&i(t.style.getPropertyValue("--tw-color"),!0)&&(r(p,l,t),r(g,l,t))})),c})(E,t);return{ref:y,app:b,palette:L,preview:H,sliders:I,inputs:M,swatches:V}},ge=(e,t)=>{t=t||{};let l=e.config,i=t.color;k(l,t),j(e._ui,(e=>{let t=e.init;t&&t(l)})),i&&e.setColor(i)};class me{static defaults=X;constructor(e,t){e=N(e);const r=this;r.config=k({},me.defaults,t),r._e=(({config:e})=>{const t={[o]:[],[s]:[],[g]:[],[p]:[]};return{emit:(l,...i)=>{!e.disabled&&t[l]&&t[l].forEach((e=>e(...i)))},on:(e,l)=>{t[e]&&t[e].push(l)},off:(e,l)=>{let i=t[e];i?t[e]=l?i.filter((e=>e!==l)):[]:null==e&&j(t,((e,l)=>{t[l]=[]}))}}})(r),r._clr=(e=>{let t,r={h:0,s:0,v:0,a:1},n=ne(r),a="",{config:o,_e:s}=e;const p=(t,l,i)=>{if(!o.disabled){k(r,t),n=i||ne(r),a=ae(n,_);let s=e._ui,{palette:p,sliders:c,inputs:h}=s;Z(s.preview.$,S,a),Z(s.ref.$,S,a),(l||!V(t.a))&&Z(c.alpha,_,n.r+","+n.g+","+n.b),V(t.h)&&Z(p.$,"hue",r.h),l!==h&&h.val(u("",o.singleInput)),l&&(c.val(r),p.update(r))}},u=(e,t)=>{let l=(e=e||o.format)===v,i=l?se(n):e===y?pe(r,!t):n;return t||l?{[e]:ae(i,e)}:i},c=(e,t,l,i)=>{o.opacity&&(l+="a");let r=i?[]:{};return l!==b&&(r.toString=()=>t||ae(e,l)),l.split("").reduce(((t,l,r)=>(t[i?r:l]=e[l])&&t),r)},h={[b]:()=>c(r,"",b,!1),[_]:e=>c(n,a,_,e),[y]:e=>c(pe(r),"",y,e),[v]:()=>se(n)};return{value:h,update:p,updateByString:(e,t)=>{let l,i,{c:r,f:n}=de(e),a=u(n),o=!I(r,a);return o&&(n===y?i=(e=>{let t=e.s/100,l=e.l/100,i=l+t*L(l,1-l);return{h:e.h,s:i?2*(1-l/i):0,v:i,a:e.a}})(r):(l=r,i=(e=>{let t=e.r/255,l=e.g/255,i=e.b/255,r=C(t,l,i),n=r-L(t,l,i),a=0===r?0:n/r;return{h:O((360+60*(0===n?0:r===t?(l-i)/n%6:r===l?(i-t)/n+2:r===i?(t-l)/n+4:0))%360),s:a,v:r,a:O(100*e.a)/100}})(r)),p(i,t,l)),o},copy:()=>j(u("",!0),(e=>{let t=navigator.clipboard;t?t.writeText(e):P(f,"",i,null,(t=>{t.value=e,t.select(),l.execCommand("copy"),R(t)}))})),start:()=>{t=u()},end:e=>{I(t,u())||s.emit(g,h,e)}}})(r),r._ui=fe(e,r),ge(r,r.config)}setOptions(e){ge(this,e)}isOpen(){return this._ui.app.isOpen()}open(){this._ui.app.open()}close(){this._ui.app.close()}toggle(){this._ui.app.toggle()}on(e,t){this._e.on(e,t)}off(e,t){this._e.off(e,t)}setColor(e){let t,l=this;if(!M(e)&&(t=[_,y,b].find((t=>t.split("").every((t=>e[t]&&!isNaN(e[t]))))),t)){let i=e.a;e.a=null!=i?i:1,t===b&&(t=l.config.format,e.h=(e.h%360+360)%360,e.s=B(e.s)/100,e.v=B(e.v)/100,t===y?e=pe(e):(e=ne(e),t===v&&(e=se(e)))),e=ae(e,t)}return l._clr.updateByString(e,!0),l}getColor(){return this._clr.value}addSwatch(e){this._ui.swatches.add(e)}removeSwatch(e){this._ui.swatches.remove(e)}enable(){this._ui.app.disable(!1)}disable(){this._ui.app.disable(!0)}reset(){this.setColor(this.config.default)}reposition(){this._ui.app.reposition()}trigger(e){let t=this,l=t._e.emit;e===p||e===g?l(e,t._clr.value,t):l(e)}destroy(){let e=this,t=e._ui;t.ref.init({preset:!1,toggle:!0}),j(t,(e=>{e.e.forEach((e=>{Y(e,!0)}))})),j(e,((t,l)=>{e[l]=null}))}}return t.default}()}));
//# sourceMappingURL=talwin.min.js.map